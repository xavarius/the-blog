<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Mobile DevOps Blueprint: Jumpstart into Android UI testing workflow on Bitrise CI</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Mobile DevOps Blueprint: Jumpstart into Android UI testing workflow on Bitrise CI</h1>
</header>
<section data-field="subtitle" class="p-summary">
Just run those tests in minutes
</section>
<section data-field="body" class="e-content">
<section name="2b75" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><figure name="c119" id="c119" class="graf graf--figure graf--leading"><img class="graf-image" data-image-id="1*i5a9u-Ec_NYsMcKm1e8MYw.jpeg" data-width="700" data-height="700" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*i5a9u-Ec_NYsMcKm1e8MYw.jpeg"><figcaption class="imageCaption"><a href="https://vectorportal.com/pt/vector/crian%C3%A7a-pulando-em-um-trampolim/35471" data-href="https://vectorportal.com/pt/vector/crian%C3%A7a-pulando-em-um-trampolim/35471" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">Creative Commons Attribution</a></figcaption></figure><h3 name="9e13" id="9e13" class="graf graf--h3 graf-after--figure graf--title">Mobile DevOps Blueprint: Jumpstart into Android UI testing workflow on Bitrise CI</h3><h4 name="fef9" id="fef9" class="graf graf--h4 graf-after--h3 graf--subtitle">Just run those tests in minutes</h4><h4 name="31d8" id="31d8" class="graf graf--h4 graf-after--h4">The Challange</h4><p name="e0d0" id="e0d0" class="graf graf--p graf-after--h4">I want to run UI tests on Bitrise CI <strong class="markup--strong markup--p-strong">asap</strong>. I have a sample test suite <br>or I’m migrating from another CI. Perhaps I want to customize the workflow a bit to run custom annotation that scopes the test suite or sets device config, etc.</p><h4 name="5631" id="5631" class="graf graf--h4 graf-after--p"><strong class="markup--strong markup--h4-strong">Who would benefit?</strong></h4><p name="d08c" id="d08c" class="graf graf--p graf-after--h4">DevOps, Automation Engineer, Android Dev, Tech Lead.</p><h4 name="4752" id="4752" class="graf graf--h4 graf-after--p">Assumptions</h4><p name="5fc8" id="5fc8" class="graf graf--p graf-after--h4">I’m assuming you’re a beginner to intermediate Bitrise user, or you’re <br>a skilled professional looking for a shortcut to just run your test suite asap. What I’m providing here is supposed to be a blueprint for you to jumpstart running your tests on Bitrise CI.</p><p name="5dc8" id="5dc8" class="graf graf--p graf-after--p">This article will cover <strong class="markup--strong markup--p-strong">the Mobile DevOps</strong> side of how to kick off UI testing on Bitrise for Android. Code included. I’ll also share a couple <br>of good practices for UI automation configuration.</p><p name="870c" id="870c" class="graf graf--p graf-after--p">I’m assuming you want a <em class="markup--em markup--p-em">quasi-infrastructure-as-a-code</em> approach, meaning you are going to use <em class="markup--em markup--p-em">bitrise.yaml</em> instead of Bitrise web console. <br>In fact, please use <em class="markup--em markup--p-em">bitrise.yaml </em>+ version control system to maintain control over changes and learn more.</p><p name="ddca" id="ddca" class="graf graf--p graf-after--p">I’m assuming you have configured the auth mechanism between your repository and Bitrise, meaning you can clone your repo while running Bitrise builds.</p><p name="9c8f" id="9c8f" class="graf graf--p graf-after--p">I’m assuming you know where to find the most recent <em class="markup--em markup--p-em">bitrise.yaml </em>version. BTW See Workflow Editor -&gt; <em class="markup--em markup--p-em">bitrise.yaml</em> tab and download it.</p><p name="c67b" id="c67b" class="graf graf--p graf-after--p">The Firebase Device Lab will be used to run the automation suite. <br>The default account is linked with your Bitrise instance — it’s recommended to provide your own account.</p><p name="df7f" id="df7f" class="graf graf--p graf-after--p graf--trailing">If you would like to learn in-depth Bitrise concepts and how to navigate and use it in an optimized way, I would recommend you read <a href="https://proandroiddev.com/be-effective-with-bitrise-ci-for-android-lessons-i-learned-the-hard-way-5a85e45a33dc" data-href="https://proandroiddev.com/be-effective-with-bitrise-ci-for-android-lessons-i-learned-the-hard-way-5a85e45a33dc" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">my article on being effective with Bitrise CI</a>. These two articles will share a few tips for sure.</p></div></div></section><section name="3575" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h4 name="7888" id="7888" class="graf graf--h4 graf--leading">The Blueprint</h4><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="yaml" name="c1a6" id="c1a6" class="graf graf--pre graf-after--h4 graf--preV2"><span class="pre--content">  <span class="hljs-attr">runTests:</span><br />    <span class="hljs-attr">steps:</span><br />      <span class="hljs-bullet">-</span> <span class="hljs-attr">git-clone:</span> { }<br />      <span class="hljs-bullet">-</span> <span class="hljs-string">cache-pull@2:</span> { }<br />      <span class="hljs-bullet">-</span> <span class="hljs-string">install-missing-android-tools@3:</span> { }<br />      <span class="hljs-bullet">-</span> <span class="hljs-string">android-sdk-update@1:</span> { }<br />      <span class="hljs-bullet">-</span> <span class="hljs-string">android-build-for-ui-testing@0:</span><br />          <span class="hljs-attr">inputs:</span><br />            <span class="hljs-bullet">-</span> <span class="hljs-attr">variant:</span> <span class="hljs-string">debug</span><br />            <span class="hljs-bullet">-</span> <span class="hljs-attr">module:</span> <span class="hljs-string">app</span><br />      <span class="hljs-bullet">-</span> <span class="hljs-string">virtual-device-testing-for-android@1:</span><br />          <span class="hljs-attr">is_skippable:</span> <span class="hljs-literal">true</span><br />          <span class="hljs-attr">inputs:</span><br />            <span class="hljs-bullet">-</span> <span class="hljs-attr">test_type:</span> <span class="hljs-string">instrumentation</span><br />            <span class="hljs-bullet">-</span> <span class="hljs-attr">test_devices:</span> <span class="hljs-string">&quot;Pixel2,28,en_US,portrait&quot;</span> <br />            <span class="hljs-bullet">-</span> <span class="hljs-attr">inst_test_targets:</span> <span class="hljs-string">&quot;annotation com.example.annotation.SMOKE&quot;</span><br />            <span class="hljs-bullet">-</span> <span class="hljs-attr">inst_use_orchestrator:</span> <span class="hljs-string">&#x27;true&#x27;</span><br />            <span class="hljs-bullet">-</span> <span class="hljs-attr">test_timeout:</span> <span class="hljs-number">3600</span><br />      <span class="hljs-bullet">-</span> <span class="hljs-string">custom-test-results-export@0.1:</span><br />          <span class="hljs-attr">inputs:</span><br />            <span class="hljs-bullet">-</span> <span class="hljs-attr">test_name:</span> <span class="hljs-string">&quot;*&quot;</span><br />            <span class="hljs-bullet">-</span> <span class="hljs-attr">search_pattern:</span> <span class="hljs-string">&quot;*&quot;</span><br />      <span class="hljs-bullet">-</span> <span class="hljs-string">cache-push@2:</span> { }</span></pre><p name="08fd" id="08fd" class="graf graf--p graf-after--pre">Just basic configs, nothing to see here, really. <em class="markup--em markup--p-em">runTest</em> steps live alongside other steps.</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="yaml" name="b9aa" id="b9aa" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">  <span class="hljs-attr">runTests:</span> <span class="hljs-comment">#name of the workflow</span><br />    <span class="hljs-attr">steps:</span> <br />      <span class="hljs-bullet">-</span> <span class="hljs-attr">git-clone:</span> { } <span class="hljs-comment"># clones repo, more config may be required, out of scope</span><br />      <span class="hljs-bullet">-</span> <span class="hljs-string">cache-pull@2:</span> { } <span class="hljs-comment"># gets prev cached artifacts, faster build</span><br />      <span class="hljs-bullet">-</span> <span class="hljs-string">install-missing-android-tools@3:</span> { } <span class="hljs-comment"># update</span><br />      <span class="hljs-bullet">-</span> <span class="hljs-string">android-sdk-update@1:</span> { } <span class="hljs-comment"># update </span><br /><span class="hljs-comment"># this</span><br /><span class="hljs-comment"># is</span><br /><span class="hljs-comment"># where </span><br /><span class="hljs-comment"># testing </span><br /><span class="hljs-comment"># happens</span><br />      <span class="hljs-bullet">-</span> <span class="hljs-string">custom-test-results-export@0.1:</span> <span class="hljs-comment"># Test reports. You want them. </span><br />          <span class="hljs-attr">inputs:</span><br />            <span class="hljs-bullet">-</span> <span class="hljs-attr">test_name:</span> <span class="hljs-string">&quot;*&quot;</span><br />            <span class="hljs-bullet">-</span> <span class="hljs-attr">search_pattern:</span> <span class="hljs-string">&quot;*&quot;</span><br />      <span class="hljs-bullet">-</span> <span class="hljs-string">cache-push@2:</span> { } <span class="hljs-comment"># push artifacts</span><br /><span class="hljs-comment"># Optionally you may like Slack notification </span></span></pre><p name="1be2" id="1be2" class="graf graf--p graf-after--pre">As said before, no magic happens here. Just housekeeping like cloning <br>the repository and being sure things are up to date. <br>Keep an eye on reports - those are useful to track what’s exactly wrong with your test including screenshots, logs, state, execution time, etc.</p><p name="17bd" id="17bd" class="graf graf--p graf-after--p">Ok, let’s explain the UI tests running part.</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="yaml" name="c060" id="c060" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-attr">runTests:</span><br />    <span class="hljs-attr">steps:</span><br />      <span class="hljs-comment"># Test builds</span><br />      <span class="hljs-bullet">-</span> <span class="hljs-string">android-build-for-ui-testing@0:</span><br />          <span class="hljs-attr">inputs:</span><br />            <span class="hljs-bullet">-</span> <span class="hljs-attr">variant:</span> <span class="hljs-string">debug</span><br />            <span class="hljs-bullet">-</span> <span class="hljs-attr">module:</span> <span class="hljs-string">app</span><br />      <span class="hljs-comment"># Testing</span><br />      <span class="hljs-bullet">-</span> <span class="hljs-string">virtual-device-testing-for-android@1:</span><br />          <span class="hljs-attr">is_skippable:</span> <span class="hljs-literal">true</span><br />          <span class="hljs-attr">inputs:</span><br />            <span class="hljs-bullet">-</span> <span class="hljs-attr">test_type:</span> <span class="hljs-string">instrumentation</span><br />            <span class="hljs-bullet">-</span> <span class="hljs-attr">test_devices:</span> <span class="hljs-string">&quot;Pixel2,28,en_US,portrait&quot;</span> <br />            <span class="hljs-bullet">-</span> <span class="hljs-attr">inst_test_targets:</span> <span class="hljs-string">&quot;annotation com.example.annotation.SMOKE&quot;</span><br />            <span class="hljs-bullet">-</span> <span class="hljs-attr">inst_use_orchestrator:</span> <span class="hljs-string">&#x27;true&#x27;</span><br />            <span class="hljs-bullet">-</span> <span class="hljs-attr">test_timeout:</span> <span class="hljs-number">3600</span></span></pre><h4 name="a77c" id="a77c" class="graf graf--h4 graf-after--pre">How test builds are being prepared?</h4><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="yaml" name="5c32" id="5c32" class="graf graf--pre graf-after--h4 graf--preV2"><span class="pre--content"><span class="hljs-comment"># Test builds creation</span><br />      <span class="hljs-bullet">-</span> <span class="hljs-string">android-build-for-ui-testing@0:</span><br />          <span class="hljs-attr">inputs:</span><br />            <span class="hljs-bullet">-</span> <span class="hljs-attr">variant:</span> <span class="hljs-string">debug</span><br />            <span class="hljs-bullet">-</span> <span class="hljs-attr">module:</span> <span class="hljs-string">app</span></span></pre><p name="5071" id="5071" class="graf graf--p graf-after--pre">No magic here again. <strong class="markup--strong markup--p-strong">Both</strong> your APK and testing APK will be built as a part of these steps. Bitrise will figure out the paths to APKs itself. <br>If you want to see the guide — here is <a href="https://www.bitrise.io/integrations/steps/android-build-for-ui-testing" data-href="https://www.bitrise.io/integrations/steps/android-build-for-ui-testing" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">the official one</a>.</p><h4 name="0884" id="0884" class="graf graf--h4 graf-after--p">The UI testing steps</h4><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="yaml" name="dc94" id="dc94" class="graf graf--pre graf-after--h4 graf--preV2"><span class="pre--content"><span class="hljs-bullet">-</span> <span class="hljs-string">virtual-device-testing-for-android@1:</span><br />          <span class="hljs-attr">is_skippable:</span> <span class="hljs-literal">true</span><br />          <span class="hljs-attr">inputs:</span><br />            <span class="hljs-bullet">-</span> <span class="hljs-attr">test_type:</span> <span class="hljs-string">instrumentation</span><br />            <span class="hljs-bullet">-</span> <span class="hljs-attr">test_devices:</span> <span class="hljs-string">&quot;Pixel2,28,en_US,portrait&quot;</span> <span class="hljs-comment">#example</span><br />            <span class="hljs-bullet">-</span> <span class="hljs-attr">inst_test_targets:</span> <span class="hljs-string">&quot;$&quot;</span><span class="hljs-string">annotation</span> <span class="hljs-string">com.example.annotation.SMOKE&quot;&quot;</span> <span class="hljs-comment">#OPTIONAL </span><br />            <span class="hljs-bullet">-</span> <span class="hljs-attr">inst_use_orchestrator:</span> <span class="hljs-string">&#x27;true&#x27;</span><br />            <span class="hljs-bullet">-</span> <span class="hljs-attr">test_timeout:</span> <span class="hljs-number">900</span></span></pre><p name="0b9e" id="0b9e" class="graf graf--p graf-after--pre">Step by step</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="yaml" name="cf2a" id="cf2a" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-attr">is_skippable:</span> <span class="hljs-literal">true</span> <span class="hljs-comment"># not required</span></span></pre><p name="978c" id="978c" class="graf graf--p graf-after--pre">You may want to have a green build even though the UI test failed because some of the tests are flaky and brittle. Maybe you just care about configuration (for now) or maybe you’re running an experiment. It’s useful. Use it whenever necessary.</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="yaml" name="0f5d" id="0f5d" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-bullet">-</span> <span class="hljs-attr">test_type:</span> <span class="hljs-string">instrumentation</span> <span class="hljs-comment"># required, other: game loop, robo</span></span></pre><p name="85d5" id="85d5" class="graf graf--p graf-after--pre">In most cases, Android UI tests are instrumentation tests. Ask Automation Engineer if that’s the truth for you.</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="yaml" name="6de9" id="6de9" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-comment"># required, schema deviceID,version,language,orientation</span><br /><span class="hljs-bullet">-</span> <span class="hljs-attr">test_devices:</span> <span class="hljs-string">&quot;Pixel2,28,en_US,portrait&quot;</span> </span></pre><p name="d0b9" id="d0b9" class="graf graf--p graf-after--pre">You have to provide at least one device, you can provide many. <br>Separated by comma.</p><p name="b046" id="b046" class="graf graf--p graf-after--p">You can find config details and a list of devices on <a href="https://github.com/bitrise-steplib/steps-virtual-device-testing-for-android/blob/master/step.yml" data-href="https://github.com/bitrise-steplib/steps-virtual-device-testing-for-android/blob/master/step.yml" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">the official Bitrise Github step codebase</a>.</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="yaml" name="f584" id="f584" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-bullet">-</span> <span class="hljs-attr">inst_test_targets:</span> <span class="hljs-string">&quot;annotation com.example.annotation.SMOKE&quot;</span> <span class="hljs-comment"># optional</span></span></pre><p name="3e5c" id="3e5c" class="graf graf--p graf-after--pre">You can define test targets — if not provided, <strong class="markup--strong markup--p-strong">every </strong>test in <em class="markup--em markup--p-em">androidTest</em> package will be triggered. You’re required to provide a <strong class="markup--strong markup--p-strong">fully qualified </strong>class or a package.</p><p name="beba" id="beba" class="graf graf--p graf-after--p">You can also configure your test targets via annotations. Annotations give you the opportunity to scope out what test to run by grouping them. It’s up to you what, how, and when to group which gives you the opportunity to adapt to the current context (release, feature branch or smoke testing?) — it&#39;s all up to you and can be done both manually and dynamically. <br>A short and sweet article on annotation is found <a href="https://evanfang.medium.com/run-specific-android-espresso-tests-by-creating-custom-annotations-using-kotlin-and-command-line-6a90e8728e3b" data-href="https://evanfang.medium.com/run-specific-android-espresso-tests-by-creating-custom-annotations-using-kotlin-and-command-line-6a90e8728e3b" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">here</a>.</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="yaml" name="e01b" id="e01b" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-bullet">-</span> <span class="hljs-attr">inst_use_orchestrator:</span> <span class="hljs-string">&#x27;true&#x27;</span> <span class="hljs-comment"># optional, default false</span></span></pre><p name="f37f" id="f37f" class="graf graf--p graf-after--pre">This listing defines if tests are using Android Test Orchestrator or not. Default: false. Ask your Automation Engineer.</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="swift" name="4760" id="4760" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-operator">-</span> test_timeout: <span class="hljs-number">900</span> # <span class="hljs-keyword">optional</span>, <span class="hljs-keyword">default</span> <span class="hljs-number">900</span><span class="hljs-operator">=</span>15m</span></pre><p name="cb6a" id="cb6a" class="graf graf--p graf-after--pre">A question: How much time must pass before<strong class="markup--strong markup--p-strong"> a test</strong> is canceled? <br>Default 900 = 15m. I would assume it should be much quicker for an efficient automation suite.</p><p name="0f00" id="0f00" class="graf graf--p graf-after--p">But <a href="https://github.com/bitrise-steplib/steps-virtual-device-testing-for-android/blob/master/step.yml" data-href="https://github.com/bitrise-steplib/steps-virtual-device-testing-for-android/blob/master/step.yml" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">there</a> is obviously much more, like</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="yaml" name="de58" id="de58" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-bullet">-</span> <span class="hljs-attr">num_flaky_test_attempts:</span> <span class="hljs-number">0</span></span></pre><p name="f59c" id="f59c" class="graf graf--p graf-after--pre">And more, and more, and more.</p><p name="ee7d" id="ee7d" class="graf graf--p graf-after--p graf--trailing">You can compare what I have shown you with the official documentation from Github. In this case for <a href="https://github.com/bitrise-steplib/steps-virtual-device-testing-for-android/blob/master/step.yml" data-href="https://github.com/bitrise-steplib/steps-virtual-device-testing-for-android/blob/master/step.yml" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">the UI testing step</a>. It’s way better than website documentation.</p></div></div></section><section name="ef9d" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="3627" id="3627" class="graf graf--p graf--leading graf--trailing">We’re finally at the end. Now, you can use provided a blueprint and run your test suite in minutes via Bitrise. Happy coding!</p></div></div></section><section name="cad0" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="d82d" id="d82d" class="graf graf--p graf--leading">I hope you like this piece. As you can see I love a fast feedback loop — <br>if you have any objections, comments, or questions — please drop a comment or DM message.</p><p name="f89e" id="f89e" class="graf graf--p graf-after--p graf--trailing">If you want to reach out, I’m based in Wrocław, Poland.<br>Here are my<a href="https://pl.linkedin.com/in/maciejmalak" data-href="https://pl.linkedin.com/in/maciejmalak" class="markup--anchor markup--p-anchor" rel="noopener ugc nofollow noopener" target="_blank"> LinkedIn</a> and<a href="https://twitter.com/monkeydevspl" data-href="https://twitter.com/monkeydevspl" class="markup--anchor markup--p-anchor" rel="noopener ugc nofollow noopener" target="_blank"> Twitter</a>.</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@maciekmalak" class="p-author h-card">Maciek Malak</a> on <a href="https://medium.com/p/4b2928880601"><time class="dt-published" datetime="2022-12-06T15:37:46.676Z">December 6, 2022</time></a>.</p><p><a href="https://medium.com/@maciekmalak/mobile-devops-blueprint-jumpstart-into-android-ui-testing-workflow-on-bitrise-ci-4b2928880601" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on June 5, 2025.</p></footer></article></body></html>